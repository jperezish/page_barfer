#!/usr/bin/env ruby
require_relative '../lib/catalog'
require_relative '../lib/product'
require_relative '../lib/catalog_settings'

require "thor"

module PageBarfer
  class Commands < Thor
    include Thor::Actions

    desc "prepare JEKYLL_SITE_NAME",
          "prepare Page Barfer for use."
    long_desc <<-LONGDESC
      The prepare command adds a directory named 'page_barfer',
      a config file in that directory named '_page_barfer_config.yml',
      and provides some instruction on what to do next.
    LONGDESC
    def prepare
      CatalogSettings.configure
      puts "Page Barfer is ready for use."
    end

    desc "barf FILE_NAME LAYOUT_NAME",
          "create pages based on LAYOUT_NAME for each record in FILE_NAME"
    long_desc <<-LONGDESC
      This is a long description

      Okay it's not really that long.
    LONGDESC
    def barf
      creators = [Product.new]
      catalog = Catalog.new
      catalog.create(creators)
      puts "Successfully imported products.json."
    end
  end
end

PageBarfer::Commands.start(ARGV)